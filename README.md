# Code: Cortical state dynamics and selective attention define thespatial pattern of correlated variability in neocortex, Yan-Liang Shi et al, nature communications, 2021

## What is contained here

This contains core code of the model analyses presented in :  

 **Yan-Liang Shi,  Nicholas A. Steinmetz,  Tirin Moore,  Kwabena Boahen,  and Tatiana A.Engel, Cortical state dynamics and selective attention define thespatial pattern of correlated variability in neocortex. Nat Commun (2021)**.

**Link:** [https://doi.org/10.1101/2020.09.02.279893](https://doi.org/10.1101/2020.09.02.279893).





* Simulation code of a dynamical system network model of population On-Off dynamics   
* Simulation code of binary-units reduced network model of population On-Off dynamics  
* Computation of noise correlation based on simulation


## Code description 


### 1. dynamical system network model

* Directory: /Dynamical_system_model
* Simulation_dynamical_system_model.m is the simulation code of the model, with input from random initial condition in FHN_init.mat. After each simulation, On/Off population phases of 121 units in attentional and control condition are generated.
* After running Simulation_dynamical_system_model.m, noise correlated is computed based on default uniform On/Off rates (r{on}=130 Hz, r_{off}=50 Hz).
* To compute the noise correlation with On/Off rate sampled from data(fitting from 2-state HMM of 31 recording sessions), we can use NC_with_input_firing_rate.m, with input 1) On/Off population phases generated by Simulation_dynamical_system_model.m, 2) distribution of On/Off rate sampled from data (distribution_firing_rate.mat). To obtain sufficient samples of On/Off rate, the sampling procedure is repeated 10 times and average noise correlations is computed.


### 2. binary-unit network model

* Directory: /Binary_units_model
* Simulation_binary_units_model.m is the simulation code of the model, with input from random initial condition in SPIN_init.mat. After each simulation, On/Off population phases of 121 units in attentional and control condition are generated.
* After running Simulation_binary_units_model.m, noise correlated is computed based on default uniform On/Off rates (r{on}=125 Hz, r_{off}=25 Hz).

